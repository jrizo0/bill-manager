(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{6380:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return i(3173)}])},4042:function(e,n,i){"use strict";i.d(n,{D:function(){return l}});let l=e=>({headers:{authorization:"Bearer ".concat(e)}})},4580:function(e,n,i){"use strict";function l(e){let n=e.toString();e instanceof Error||!e.message||(n=e.message),console.error("ONERROR: -->",e),alert(n)}i.d(n,{q:function(){return l}})},3173:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return I}});var l=i(7458),r=i(880),t=i(890),s=i(3856),a=i(8167),c=i(1606),o=i(9343),d=i(99),x=i(2933),h=i(1612),u=i(4759),b=i(2053),f=i(670),p=i(4020),j=i(3753),m=i(522),g=i(2983);function y(e){let{onConfirm:n}=e,[i,r]=g.useState(!1),t=()=>{r(!0)},a=()=>{r(!1)},c=()=>{r(!1),n()};return(0,l.jsxs)("div",{children:[(0,l.jsx)(m.Z,{color:"error","aria-label":"upload picture",component:"label",onClick:t,children:(0,l.jsx)(h.Z,{})}),(0,l.jsxs)(u.Z,{open:i,onClose:a,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,l.jsx)(j.Z,{id:"alert-dialog-title",children:"Confirmation"}),(0,l.jsx)(f.Z,{children:(0,l.jsx)(p.Z,{id:"alert-dialog-description",children:"Are you sure you wnat to delete the bill?"})}),(0,l.jsxs)(b.Z,{children:[(0,l.jsx)(s.Z,{onClick:a,children:"Cancel"}),(0,l.jsx)(s.Z,{onClick:c,children:"Confirm"})]})]})]})}let Z=e=>{let{bill:n,onPayBill:i,onDeleteBill:h,isLoading:u}=e;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(o.ZP,{sx:{py:1,display:"flex",justifyContent:"space-between",alignItems:"center"},divider:!0,secondaryAction:u?(0,l.jsx)(a.Z,{size:20}):(0,l.jsx)(y,{onConfirm:()=>{h(n.billID)}}),children:[(0,l.jsxs)(t.Z,{sx:{display:"flex",flexDirection:"column"},children:[(0,l.jsxs)(t.Z,{sx:{display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"baseline"},children:[(0,l.jsxs)(x.Z,{variant:"body1",sx:{fontWeight:"bold",ml:2},children:[n.tag.trim().split("\n").slice(0,3),":"]}),(0,l.jsx)(d.Z,{title:"Copy",children:(0,l.jsx)(s.Z,{variant:"text",onClick:()=>{navigator.clipboard.writeText(n.reference)},size:"large",sx:{color:"#000000",textTransform:"none"},children:n.reference})}),(()=>{let e=n.expirationDay-new Date().getDate();return!n.paid&&(e>0?(0,l.jsxs)(x.Z,{variant:"body1",sx:{fontWeight:"regular",mx:2},children:["Expires in ",e," days"]}):(0,l.jsxs)(x.Z,{variant:"body1",sx:{fontWeight:"bold",mx:2,color:"#FF0000"},children:["Expired ",-e," days ago"]}))})()]}),(0,l.jsx)(c.Z,{href:n.paymentWeb,target:"_blank",rel:"noopener noreferrer",sx:{mx:2,pb:1,fontWeight:"regular"},children:new URL(n.paymentWeb).host})]}),(0,l.jsx)(t.Z,{sx:{mx:2},children:n.paid?(0,l.jsx)("span",{className:"billPaid",children:"Pagada"}):(0,l.jsx)(r.Z,{loading:u,variant:"contained",disabled:u,onClick:()=>i(n.billID),children:"Pay bill"})})]})})};var w=i(1227),v=i(4042),C=i(7959),D=i(4865),_=i(903),N=i(4445),k=i(4580);let E=()=>{let[e,n]=(0,g.useState)(),[i,r]=(0,g.useState)(!1),{token:s}=(0,g.useContext)(w.M);async function a(i){r(!0);try{await _.b.post("bills","/payments/".concat(i),(0,v.D)(s));let l=e.findIndex(e=>e.billID===i),r={...e[l],paid:!0},t=[...e];t[l]=r,n(t)}catch(e){(0,k.q)(e)}r(!1)}async function c(e){r(!0);try{await _.b.del("bills","/bills/".concat(e),(0,v.D)(s)),n(n=>[...n.filter(n=>n.billID!=e)])}catch(e){(0,k.q)(e)}r(!1)}return(0,g.useEffect)(()=>{async function e(){try{let e=await _.b.get("bills","/bills",(0,v.D)(s));n(e)}catch(e){(0,k.q)(e)}r(!1)}s&&e()},[s]),(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"Home",children:s?(0,l.jsxs)("div",{className:"bills",children:[(0,l.jsx)(x.Z,{variant:"h5",component:"div",sx:{mt:4,mx:2},children:"Your bills"}),(0,l.jsx)(C.Z,{children:(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(C.Z,{children:[(0,l.jsxs)(D.Z,{divider:!0,href:"/bills/new",sx:{py:3,borderRadius:"10px"},children:[(0,l.jsx)(N.HlX,{size:17}),(0,l.jsx)(t.Z,{mx:{marginInlineStart:4,fontWeight:"bold"},children:"Create a new bill"})]}),e&&e.map(e=>(0,l.jsx)(Z,{bill:e,isLoading:i,onPayBill:a,onDeleteBill:c},e.billID))]})})})]}):(0,l.jsxs)("div",{className:"lander",children:[(0,l.jsx)("h1",{children:"Scratch"}),(0,l.jsx)("p",{className:"text-muted",children:"A simple bill manager app"})]})})})};var I=E},454:function(){}},function(e){e.O(0,[963,648,145,23,774,888,179],function(){return e(e.s=6380)}),_N_E=e.O()}]);